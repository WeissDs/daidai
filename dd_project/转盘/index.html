<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>大转盘</title>
  <style>
    * { /* 重置默认样式 */
        margin: 0;
        padding: 0;
        border: none;
        outline: none;
        user-select: none;
      }
      html {
        width: 100%;
        height: 100%;
      }
      body {
        width: 100%;
        height: 100%;
        background-color: #492f88;
        /* background: url('https://img2.baidu.com/it/u=1970607438,2737872407&fm=253&fmt=auto&app=138&f=JPEG?w=780&h=361') no-repeat; */
        /* background-size: auto 100%; */
      }
      .wrapper {
        margin: 120px auto;
        position: relative;
        height: 200px;
        width: 200px;
        padding: 20px;
        /* margin: 20px; */
        /* background-color: #ff5555; */
        background-color: #ff437a;
        box-shadow: #1d011c 0px 0px 29px 4px;
        border-radius: 50%;
        transform: scale(1.2);
      }
      .light {
        position: absolute;
        height: 6px;
        width: 6px;
        border-radius: 50%;
        top: 5px;
        left: 115px;
        transform-origin: 5px 115px;
      }
      .light-twinkling {
        animation: 1s twinkling 3, 100ms 3s twinkling 3;
      }
      .light:nth-child(2n) {
        background-color: #fafce7;
      }
      .light:nth-child(2n+1) {
        background-color: #ffe58b;
      }
      .panel {
        position: relative;
        height: 200px;
        width: 200px;
        background-color: #b7b7b7;
        border-radius: 100px;
        transform: scale(1.03);
      }
      .sector {
        position: absolute;
        left: 100px;
        top: 0px;
        width: 100px;
        height: 200px;
        font-size: 14px;
        border-radius: 0px 100px 100px 0;
        overflow: hidden;
        transform-origin: left center;
      }
      .sector:nth-child(1) {
        transform: rotate(-18deg);
      }
      .sector:nth-child(11) {
        transform: rotate(-9deg);
      }
      .sector:nth-child(2) {
        transform: rotate(18deg);
      }
      .sector:nth-child(3) {
        transform: rotate(54deg);
      }
      .sector:nth-child(4) {
        transform: rotate(90deg);
      }
      .sector:nth-child(5) {
        transform: rotate(126deg);
      }
      .sector:nth-child(6) {
        transform: rotate(162deg);
      }
      .sector:nth-child(7) {
        transform: rotate(198deg);
      }
      .sector:nth-child(8) {
        transform: rotate(234deg);
      }
      .sector:nth-child(9) {
        transform: rotate(270deg);
      }
      .sector:nth-child(10) {
        transform: rotate(306deg);
      }
      .sector:nth-child(2n+1) .sector-inner {
        background: #fef6e0;
        background: #fff5db;
        /* background-color: #ffd6a1; */
      }
      .sector:nth-child(2n) .sector-inner {
        background: #ffffff;
        /* background-color: #4a015e; */
      }
      .sector-inner {
        text-align: center;
        display: block;
        width: 40px;
        padding: 5px 3px 0 57px;
        height: 195px;
        transform: translateX(-100px) rotate(36deg);
        transform-origin: right center;
        border-radius: 100px 0 0 100px;
      }
      .sector-inner span {
        display: block;
        transform-origin: center;
        transform: rotate(-19deg);
        /* color: #d46854; */
        color: #722300;
      }
      .pointer {
        position: absolute;
        left: 68px;
        top: 68px;
        /* left: 50%; */
        /* top: 50%; */
        /* transform: translate(-50%, -50%); */
        z-index: 10;
        height: 50px;
        width: 50px;
        padding: 6px;
        /* background-color: #ff5350; */
        background-color: #fd4279;
        border-radius: 50%;
        /* border: 1px solid #ff5350; */
        border: 1px solid #fd4279;
        transition: transform 3s cubic-bezier(.2,.93,.43,1);
        box-shadow: 0px 0px 0px 5px rgb(255 145 107 / 50%);
      }
      .pointer::after {
        content: '';
        position: absolute;
        left: 50%;
        top: -57px;
        transform: translateX(-50%);
        border-width: 30px 7px;
        border-style: solid;
        border-color: transparent;
        border-bottom-color: #fd4279;
        transform-origin: center;
      }
      p {
        position: absolute;
        left: 50%;
        top: 50%;
        transform: translate(-50%, -50%);
        z-index: 100;
        font-size: 20px;
        color: #FFF;
      }
      .result {
        text-align: center;
        margin: -28px auto;
        color: #fff;
        font-weight: bold;
        font-size: 16px;
      }

      @keyframes twinkling {
        50% { background: transparent; }
      }
  </style>
</head>
<body>
  <div class="wrapper">
    <div class="light"></div>
    <div class="light"></div>
    <div class="light"></div>
    <div class="light"></div>
    <div class="light"></div>
    <div class="light"></div>
    <div class="light"></div>
    <div class="light"></div>
    <div class="light"></div>
    <div class="light"></div>
    <div class="light"></div>
    <div class="light"></div>
    <div class="light"></div>
    <div class="light"></div>
    <div class="light"></div>
    <div class="light"></div>
    <div class="light"></div>
    <div class="light"></div>
    <div class="light"></div>
    <div class="light"></div>
    <div class="panel">
      <div class="sector">
        <div class="sector-inner">
          <span>谢谢参与</span>
        </div>
      </div>
      <div class="sector">
        <div class="sector-inner">
          <span>牛很鲜</span>
        </div>
      </div>
      <div class="sector">
        <div class="sector-inner">
          <span>鑫泽园·椰子鸡</span>
        </div>
      </div>
      <div class="sector">
        <div class="sector-inner">
          <span>魔宗·日式烤肉</span>
        </div>
      </div>
      <div class="sector">
        <div class="sector-inner">
          <span>代代下厨</span>
        </div>
      </div>
      <div class="sector">
        <div class="sector-inner">
          <span>大渔铁板烧</span>
        </div>
      </div>
      <div class="sector">
        <div class="sector-inner">
          <span>路边摊</span>
        </div>
      </div>
      <div class="sector">
        <div class="sector-inner">
          <span>粗茶淡饭·蒸鲜</span>
        </div>
      </div>
      <div class="sector">
        <div class="sector-inner">
          <span>O`eat</span>
        </div>
      </div>
      <div class="sector">
        <div class="sector-inner">
          <span>那时新疆</span>
        </div>
      </div>
      <div class="pointer">
      </div>
      <p class="pointer-txt">GO</p>
    </div>
  </div>
  <div class="result"></div>
  

  <script>
    let getEle = document.getElementsByClassName.bind(document);
    let pointer = getEle('pointer')[0];
    let pointerTxt = getEle('pointer-txt')[0];
    let result = getEle('result')[0];
    let lights = Array.prototype.slice.call(getEle('light'));

    let onRotation = false; // 记录当前是否正在旋转，如果正在旋转，就不能继续点击了
    let reward = ['谢谢参与', '牛很鲜潮汕牛肉火锅 大奖', '鑫泽园·椰子鸡 大奖', '魔宗·日式烤肉 大奖', '代代下厨 特等奖', 
    '大渔铁板烧 大奖', '路边摊', '粗茶淡饭·蒸鲜 大奖', 'O`eat 大奖', '那时新疆 大奖'];

    lights.forEach((item,index) => {
      item.style.transform = `rotate(${18*(index+1)}deg)`
    })

    // 根据随机角度获取奖励
    let getReward = (function() {
      currentDeg = 0;
      return function() {
        // 转三圈到四圈
        let rotateDeg = Math.random() * 360 + 1080;
        currentDeg += rotateDeg;
        let rewardText = reward[Math.floor((currentDeg + 18) % 360 / 36)]
        return {
          deg: currentDeg,
          text: rewardText === '谢谢参与' ? '菜狗' : '恭喜潘潘获得: ' + rewardText
        }
      }
    })();

    function roll() {
      if (onRotation) return;
      console.log('开始抽奖');
      onRotation = true;
      lights.forEach(light => { light.className += ' light-twinkling'; });
      let nextStatus = getReward();
      console.log(nextStatus)
      result.innerText = nextStatus.text;
      result.style.display = 'none';
      pointer.style.transform = `rotateZ(${nextStatus.deg}deg)`;
    }
    pointer.addEventListener('click', roll);
    pointerTxt.addEventListener('click', roll);
    pointer.addEventListener('transitionend', () => {
      console.log('抽奖结束');
      setTimeout(() => { // 等闪烁三下结束
        onRotation = false;
        lights.forEach(light => { light.className = 'light'; });
        result.style.display = 'block';
      }, 300);
    })
  </script>
</body>
</html>