<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>try</title>
</head>
<body>

<div>
    <button id="view"></button>
    <input id="txt" type="text" value="">
</div>

<script>
    let oDiv=document.getElementById('view');
    let oTxt=document.getElementById('txt');

    function bothway(obj, attr, objInput){
    	if(arguments.length!==3){
    		alert('请传入正确参数: 对象, 定义对象属性, 需要绑定的dom');
    		return;
    	}
		Object.defineProperty(obj, attr, {
			get(){
				return this._val;
			},
			set(newValue){
				if(this._val === newValue){
					return;
				}
				this._val = newValue;
				objInput.value = newValue;
				oDiv.innerHTML = newValue;
			}
		})
    }

    var data = {}
    bothway(data, 'inputValue', oTxt)
    // 改变对象的属性 input的value自动改变
    data.inputValue = 40;
    setTimeout(function(){
    	data.inputValue = 50
    },1000)
    // input改变 手动改变对象的属性值
    oTxt.addEventListener('input',function(e){
		data.inputValue = e.target.value;
		console.log('input:'+data.inputValue);
    })
    oTxt.addEventListener('keyup',function(e){
		data.inputValue = e.target.value;
		console.log('keyup:'+data.inputValue);
    })
    oTxt.addEventListener('change',function(e){
		data.inputValue = e.target.value;
		console.log('change:'+data.inputValue);
    })


    function timeout(num,time){
    	// console.log(fn);
		return new Promise(function(resolve,reject){
			setTimeout(function(){
				console.log(num);
				resolve(num);
			},time)
		})
    }

    
    
    Promise.all([timeout(1,2000),timeout(2,4000)]).then(res=>{
		let [a,b] = res;
		console.log(a,b)
    })

    


















	// definProperty 双向绑定demo
 //    function defineProperty(obj, attr){
	//     var val;
	//     Object.defineProperty(obj, attr, {
	//         get: function () {
	//             return val;
	//         },
	//         set: function (newValue) {
	//             if (newValue === val){
	//                 return;
	//             }
	//             val = newValue;
	//             oTxt.value = newValue;
	//             oDiv.innerHTML = newValue;
	//         }
	//     });
	// }
	// var o = {};
	// defineProperty(o, 'txt');
	// oTxt.addEventListener("keyup", function(e){
	// 	o.txt = e.target.value;
	// })

	// setInterval(function(){
	// 	o.txt++
	// },2000)

	

</script>

</body>
</html>